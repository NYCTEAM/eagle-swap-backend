# NFT Token ID è‡ªåŠ¨æ¸…ç†æœºåˆ¶è¯¦è§£

## ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨æ¸…ç†ï¼Ÿ

### é—®é¢˜åœºæ™¯

```
æ—¶é—´çº¿ï¼š12:00 PM
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‘¤ ç”¨æˆ· A: "æˆ‘è¦ä¹° Level 1 NFTï¼"
   â†“
ğŸ–¥ï¸ åç«¯: "å¥½çš„ï¼Œç»™ä½ åˆ†é… Token ID #1"
   â†“
ğŸ“ æ•°æ®åº“è®°å½•:
   Token ID: 1
   çŠ¶æ€: reserved (é¢„ç•™ä¸­)
   ç”¨æˆ·: 0xABC...
   è¿‡æœŸæ—¶é—´: 12:30 PM (30åˆ†é’Ÿå)
   â†“
ğŸ‘¤ ç”¨æˆ· A: "ç­‰ç­‰ï¼Œæˆ‘é’±åŒ…æ²¡é’±äº†..." âŒ å…³é—­æµè§ˆå™¨
   â†“
â“ Token ID #1 æ€ä¹ˆåŠï¼Ÿ
```

### å¦‚æœä¸æ¸…ç†ä¼šæ€æ ·ï¼Ÿ

```
âŒ åæƒ…å†µï¼šToken ID #1 æ°¸è¿œè¢«é”å®š

Token ID #1: â›” è¢«ç”¨æˆ· A é¢„ç•™ï¼Œä½†æ°¸è¿œä¸ä¼šé“¸é€ 
Token ID #2: âœ… æ­£å¸¸é“¸é€ 
Token ID #3: âœ… æ­£å¸¸é“¸é€ 
Token ID #4: â›” è¢«ç”¨æˆ· B é¢„ç•™ï¼Œä½†å–æ¶ˆäº†äº¤æ˜“
Token ID #5: âœ… æ­£å¸¸é“¸é€ 
...
Token ID #100: â›” è¢«ç”¨æˆ· C é¢„ç•™ï¼Œä½†ç½‘ç»œè¶…æ—¶
...

ç»“æœï¼š
- æ€»ä¾›åº”é‡ 13900 ä¸ª
- å®é™…å¯ç”¨ï¼šå¯èƒ½åªæœ‰ 10000 ä¸ª
- æµªè´¹äº† 3900 ä¸ª Token IDï¼ğŸ’¸
```

---

## âœ… è‡ªåŠ¨æ¸…ç†æœºåˆ¶å¦‚ä½•å·¥ä½œ

### å®Œæ•´æµç¨‹

```
æ—¶é—´: 12:00 PM - ç”¨æˆ·è¯·æ±‚é“¸é€ 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ ç”¨æˆ· A è¯·æ±‚é“¸é€ 
   POST /api/nft/request-mint
   {
     "userAddress": "0xABC...",
     "level": 1
   }

2ï¸âƒ£ åç«¯åˆ†é… Token ID
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Token ID: 1                         â”‚
   â”‚ çŠ¶æ€: reserved (é¢„ç•™)               â”‚
   â”‚ ç”¨æˆ·: 0xABC...                      â”‚
   â”‚ é¢„ç•™æ—¶é—´: 12:00 PM                  â”‚
   â”‚ è¿‡æœŸæ—¶é—´: 12:30 PM (30åˆ†é’Ÿå)      â”‚
   â”‚ ç­¾å: 0x1234...                     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ï¸âƒ£ è¿”å›ç»™å‰ç«¯
   {
     "globalTokenId": 1,
     "signature": "0x1234...",
     "deadline": 1733342400,  // 12:30 PM
     "expiresAt": "2025-12-04T12:30:00Z"
   }

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ—¶é—´: 12:05 PM - ç”¨æˆ·æˆåŠŸé“¸é€ ï¼ˆæ­£å¸¸æƒ…å†µï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

4ï¸âƒ£ ç”¨æˆ·è°ƒç”¨åˆçº¦
   contract.mintWithSignature(1, 1, 0, deadline, signature)
   âœ… äº¤æ˜“æˆåŠŸï¼

5ï¸âƒ£ å‰ç«¯ç¡®è®¤é“¸é€ 
   POST /api/nft/confirm-mint
   {
     "globalTokenId": 1,
     "txHash": "0xabc..."
   }

6ï¸âƒ£ åç«¯æ›´æ–°çŠ¶æ€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Token ID: 1                         â”‚
   â”‚ çŠ¶æ€: minted (å·²é“¸é€ ) âœ…            â”‚
   â”‚ ç”¨æˆ·: 0xABC...                      â”‚
   â”‚ é“¸é€ æ—¶é—´: 12:05 PM                  â”‚
   â”‚ äº¤æ˜“å“ˆå¸Œ: 0xabc...                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ—¶é—´: 12:31 PM - è‡ªåŠ¨æ¸…ç†è¿‡æœŸé¢„ç•™
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å‡è®¾ç”¨æˆ· B åœ¨ 12:00 PM é¢„ç•™äº† Token ID #2ï¼Œä½†ä¸€ç›´æ²¡æœ‰é“¸é€ ...

7ï¸âƒ£ ç³»ç»Ÿæ£€æŸ¥è¿‡æœŸé¢„ç•™
   å½“å‰æ—¶é—´: 12:31 PM
   
   æ£€æŸ¥æ•°æ®åº“:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Token ID: 2                         â”‚
   â”‚ çŠ¶æ€: reserved                      â”‚
   â”‚ è¿‡æœŸæ—¶é—´: 12:30 PM âš ï¸ å·²è¿‡æœŸï¼     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

8ï¸âƒ£ è‡ªåŠ¨æ¸…ç†
   ğŸ§¹ åˆ é™¤é¢„ç•™è®°å½•
   ğŸ§¹ ä»åˆ†é…è¡¨ä¸­ç§»é™¤
   ğŸ§¹ æ›´æ–°ç»Ÿè®¡: total_reserved - 1

9ï¸âƒ£ Token ID #2 é‡æ–°å¯ç”¨ï¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Token ID: 2                         â”‚
   â”‚ çŠ¶æ€: âœ… å¯ç”¨                       â”‚
   â”‚ å¯ä»¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªç”¨æˆ·                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ ä¸‹æ¬¡æœ‰ç”¨æˆ·è¯·æ±‚é“¸é€ æ—¶ï¼ŒToken ID #2 å¯ä»¥å†æ¬¡è¢«åˆ†é…ï¼
```

---

## ğŸ“Š æ•°æ®åº“çŠ¶æ€å˜åŒ–

### çŠ¶æ€ 1: åˆå§‹çŠ¶æ€
```sql
-- nft_global_stats
total_minted: 0
total_reserved: 0
last_token_id: 0

-- nft_token_reservations
(ç©ºè¡¨)
```

### çŠ¶æ€ 2: ç”¨æˆ· A é¢„ç•™ Token ID #1 (12:00 PM)
```sql
-- nft_global_stats
total_minted: 0
total_reserved: 1  â¬†ï¸ å¢åŠ 
last_token_id: 1   â¬†ï¸ æ›´æ–°

-- nft_token_reservations
| global_token_id | user_address | status  | expires_at |
|-----------------|--------------|---------|------------|
| 1               | 0xABC...     | active  | 12:30 PM   |
```

### çŠ¶æ€ 3: ç”¨æˆ· A æˆåŠŸé“¸é€  (12:05 PM)
```sql
-- nft_global_stats
total_minted: 1    â¬†ï¸ å¢åŠ 
total_reserved: 0  â¬‡ï¸ å‡å°‘
last_token_id: 1

-- nft_token_reservations
| global_token_id | user_address | status | expires_at |
|-----------------|--------------|--------|------------|
| 1               | 0xABC...     | used   | 12:30 PM   |

-- nft_global_token_allocation
| global_token_id | status | owner_address | tx_hash   |
|-----------------|--------|---------------|-----------|
| 1               | minted | 0xABC...      | 0xabc...  |
```

### çŠ¶æ€ 4: ç”¨æˆ· B é¢„ç•™ Token ID #2ï¼Œä½†æ²¡é“¸é€  (12:00 PM)
```sql
-- nft_token_reservations
| global_token_id | user_address | status  | expires_at |
|-----------------|--------------|---------|------------|
| 1               | 0xABC...     | used    | 12:30 PM   |
| 2               | 0xDEF...     | active  | 12:30 PM   | âš ï¸ é¢„ç•™ä¸­
```

### çŠ¶æ€ 5: è‡ªåŠ¨æ¸…ç† (12:31 PM)
```sql
-- æ¸…ç†å‰
| global_token_id | user_address | status  | expires_at |
|-----------------|--------------|---------|------------|
| 2               | 0xDEF...     | active  | 12:30 PM   | âš ï¸ å·²è¿‡æœŸ

-- æ¸…ç†å
| global_token_id | user_address | status  | expires_at |
|-----------------|--------------|---------|------------|
| 2               | 0xDEF...     | expired | 12:30 PM   | âœ… æ ‡è®°ä¸ºè¿‡æœŸ

-- nft_global_token_allocation ä¸­çš„è®°å½•è¢«åˆ é™¤
-- Token ID #2 é‡æ–°å¯ç”¨ï¼
```

---

## ğŸ”§ æ¸…ç†è§¦å‘æ—¶æœº

### è‡ªåŠ¨è§¦å‘

```typescript
// æ¯æ¬¡æœ‰æ–°çš„é“¸é€ è¯·æ±‚æ—¶ï¼Œå…ˆæ¸…ç†è¿‡æœŸé¢„ç•™
router.post('/request-mint', async (req, res) => {
  // 1. å…ˆæ¸…ç†è¿‡æœŸçš„é¢„ç•™
  NFTTokenManager.cleanExpiredReservations(); // ğŸ§¹
  
  // 2. ç„¶ååˆ†é…æ–°çš„ Token ID
  const globalTokenId = NFTTokenManager.getNextAvailableTokenId();
  
  // ...
});
```

### æ¸…ç†é€»è¾‘

```typescript
static cleanExpiredReservations(): void {
  const now = Math.floor(Date.now() / 1000); // å½“å‰æ—¶é—´æˆ³

  // 1. æŸ¥æ‰¾æ‰€æœ‰è¿‡æœŸçš„é¢„ç•™
  const expired = db.prepare(`
    SELECT global_token_id FROM nft_token_reservations 
    WHERE status = 'active' AND expires_at < ?
  `).all(now);

  if (expired.length > 0) {
    console.log(`ğŸ§¹ å‘ç° ${expired.length} ä¸ªè¿‡æœŸçš„é¢„ç•™`);

    // 2. æ ‡è®°ä¸ºè¿‡æœŸ
    db.prepare(`
      UPDATE nft_token_reservations 
      SET status = 'expired'
      WHERE status = 'active' AND expires_at < ?
    `).run(now);

    // 3. åˆ é™¤åˆ†é…è®°å½•ï¼ˆé‡Šæ”¾ Token IDï¼‰
    db.prepare(`
      DELETE FROM nft_global_token_allocation 
      WHERE global_token_id IN (...) AND status = 'reserved'
    `).run(...tokenIds);

    // 4. æ›´æ–°ç»Ÿè®¡
    db.prepare(`
      UPDATE nft_global_stats 
      SET total_reserved = total_reserved - ?
    `).run(expired.length);

    console.log(`âœ… å·²æ¸…ç† ${expired.length} ä¸ªè¿‡æœŸé¢„ç•™ï¼ŒToken ID é‡æ–°å¯ç”¨`);
  }
}
```

---

## ğŸ“ˆ å®é™…ä¾‹å­

### åœºæ™¯ï¼šé«˜å³°æœŸé“¸é€ 

```
12:00 PM - 100 ä¸ªç”¨æˆ·åŒæ—¶è¯·æ±‚é“¸é€ 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åˆ†é… Token ID:
âœ… ç”¨æˆ· 1-50: æˆåŠŸé“¸é€  (Token ID 1-50)
âš ï¸ ç”¨æˆ· 51-80: é¢„ç•™äº†ä½†ç½‘ç»œæ…¢ï¼Œè¿˜åœ¨å¤„ç†ä¸­ (Token ID 51-80)
âŒ ç”¨æˆ· 81-100: å–æ¶ˆäº†äº¤æ˜“ (Token ID 81-100)

æ•°æ®åº“çŠ¶æ€:
- total_minted: 50
- total_reserved: 50 (Token ID 51-100)
- last_token_id: 100

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
12:15 PM - ç”¨æˆ· 51-60 æˆåŠŸé“¸é€ 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ•°æ®åº“çŠ¶æ€:
- total_minted: 60 â¬†ï¸
- total_reserved: 40 â¬‡ï¸ (Token ID 61-100)
- last_token_id: 100

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
12:31 PM - è‡ªåŠ¨æ¸…ç†è¿‡æœŸé¢„ç•™
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ£€æŸ¥è¿‡æœŸ:
- Token ID 61-100: è¿‡æœŸæ—¶é—´ 12:30 PM âš ï¸ å·²è¿‡æœŸ
- å…¶ä¸­ Token ID 61-70 å·²ç»é“¸é€  âœ… ä¸æ¸…ç†
- Token ID 71-100 è¿˜æ˜¯ reserved âŒ éœ€è¦æ¸…ç†

æ¸…ç†ç»“æœ:
ğŸ§¹ æ¸…ç†äº† 30 ä¸ªè¿‡æœŸé¢„ç•™ (Token ID 71-100)
âœ… Token ID 71-100 é‡æ–°å¯ç”¨ï¼

æ•°æ®åº“çŠ¶æ€:
- total_minted: 60
- total_reserved: 10 â¬‡ï¸ (Token ID 61-70 è¿˜åœ¨å¤„ç†ä¸­)
- last_token_id: 100

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
12:35 PM - æ–°ç”¨æˆ·è¯·æ±‚é“¸é€ 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¯ç”¨ Token ID:
- Token ID 1-60: å·²é“¸é€  âŒ
- Token ID 61-70: é¢„ç•™ä¸­ âŒ
- Token ID 71: å¯ç”¨ï¼âœ… (åˆšæ‰è¢«æ¸…ç†é‡Šæ”¾çš„)

åˆ†é… Token ID 71 ç»™æ–°ç”¨æˆ·ï¼ğŸ‰
```

---

## ğŸ¯ å…³é”®è¦ç‚¹

### 1. ä¸ºä»€ä¹ˆæ˜¯ 30 åˆ†é’Ÿï¼Ÿ

```
â±ï¸ ç”¨æˆ·æ“ä½œæ—¶é—´çº¿:

1. ç‚¹å‡»è´­ä¹°: 1ç§’
2. é’±åŒ…å¼¹çª—: 5ç§’
3. ç”¨æˆ·ç¡®è®¤: 10ç§’
4. æ£€æŸ¥ USDT æˆæƒ: 5ç§’
5. æˆæƒäº¤æ˜“ï¼ˆå¦‚æœéœ€è¦ï¼‰: 2-3åˆ†é’Ÿ
6. ç­‰å¾…æˆæƒç¡®è®¤: 1-2åˆ†é’Ÿ
7. é“¸é€ äº¤æ˜“: 1åˆ†é’Ÿ
8. ç­‰å¾…é“¸é€ ç¡®è®¤: 1-2åˆ†é’Ÿ

æ€»è®¡: æœ€å¤š 10 åˆ†é’Ÿ

30 åˆ†é’Ÿ = 3å€ç¼“å†²æ—¶é—´ âœ…
```

### 2. ä¸ä¼šè¯¯åˆ æ­£åœ¨é“¸é€ çš„ Token ID

```
âœ… å®‰å…¨æœºåˆ¶:

æ—¶é—´: 12:00 PM - ç”¨æˆ·å¼€å§‹é“¸é€ 
æ—¶é—´: 12:25 PM - ç”¨æˆ·äº¤æ˜“ä¸Šé“¾
æ—¶é—´: 12:26 PM - å‰ç«¯è°ƒç”¨ confirm-mint
æ—¶é—´: 12:26 PM - çŠ¶æ€æ”¹ä¸º "minted" âœ…
æ—¶é—´: 12:31 PM - æ¸…ç†æ£€æŸ¥: status = "minted" â†’ è·³è¿‡ âœ…

åªæ¸…ç† status = "reserved" ä¸”è¿‡æœŸçš„è®°å½•ï¼
```

### 3. Token ID é‡æ–°å¯ç”¨

```
Token ID çš„ç”Ÿå‘½å‘¨æœŸ:

1. å¯ç”¨ (available)
   â†“
2. é¢„ç•™ (reserved) - 30åˆ†é’Ÿå€’è®¡æ—¶
   â†“
   â”œâ”€â†’ æˆåŠŸé“¸é€  â†’ æ°¸ä¹…å ç”¨ (minted) âœ…
   â””â”€â†’ è¿‡æœŸ â†’ æ¸…ç† â†’ é‡æ–°å¯ç”¨ (available) ğŸ”„
```

---

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### æŸ¥çœ‹å½“å‰é¢„ç•™æƒ…å†µ

```sql
-- æŸ¥çœ‹æ´»è·ƒçš„é¢„ç•™
SELECT 
  global_token_id,
  user_address,
  datetime(reserved_at, 'unixepoch') as reserved_time,
  datetime(expires_at, 'unixepoch') as expires_time,
  (expires_at - strftime('%s', 'now')) / 60 as minutes_left
FROM nft_token_reservations
WHERE status = 'active'
ORDER BY expires_at;
```

### æŸ¥çœ‹è¿‡æœŸä½†æœªæ¸…ç†çš„é¢„ç•™

```sql
-- æŸ¥çœ‹åº”è¯¥è¢«æ¸…ç†çš„é¢„ç•™
SELECT 
  global_token_id,
  user_address,
  datetime(expires_at, 'unixepoch') as expired_at,
  (strftime('%s', 'now') - expires_at) / 60 as minutes_overdue
FROM nft_token_reservations
WHERE status = 'active' 
  AND expires_at < strftime('%s', 'now')
ORDER BY expires_at;
```

### æ‰‹åŠ¨è§¦å‘æ¸…ç†

```bash
# é€šè¿‡ API è§¦å‘ï¼ˆä»»ä½•é“¸é€ è¯·æ±‚éƒ½ä¼šè§¦å‘ï¼‰
curl -X POST http://localhost:3001/api/nft/request-mint \
  -H "Content-Type: application/json" \
  -d '{"userAddress":"0x123","level":1}'
```

---

## âœ… æ€»ç»“

**è‡ªåŠ¨æ¸…ç†æœºåˆ¶ = é˜²æ­¢ Token ID æµªè´¹çš„ä¿é™©æœºåˆ¶**

- ğŸ”’ é¢„ç•™ Token ID æ—¶è®¾ç½® 30 åˆ†é’Ÿè¿‡æœŸ
- â° æ¯æ¬¡æ–°è¯·æ±‚æ—¶è‡ªåŠ¨æ£€æŸ¥å¹¶æ¸…ç†è¿‡æœŸé¢„ç•™
- ğŸ”„ æ¸…ç†åçš„ Token ID é‡æ–°è¿›å…¥å¯ç”¨æ± 
- âœ… ç¡®ä¿ 13900 ä¸ª Token ID ä¸ä¼šè¢«æµªè´¹
- ğŸ›¡ï¸ ä¸ä¼šè¯¯åˆ æ­£åœ¨é“¸é€ çš„ Token ID

**å°±åƒé¤å…è®¢ä½ä¸€æ ·ï¼š**
- ä½ é¢„è®¢äº† 12:00 çš„åº§ä½
- å¦‚æœ 12:30 è¿˜æ²¡åˆ°ï¼Œåº§ä½è‡ªåŠ¨é‡Šæ”¾
- ä¸‹ä¸€ä¸ªå®¢äººå¯ä»¥åè¿™ä¸ªåº§ä½
- ä½†å¦‚æœä½  12:25 åˆ°äº†ï¼Œåº§ä½å°±æ˜¯ä½ çš„ï¼Œä¸ä¼šè¢«é‡Šæ”¾ï¼
